<!DOCTYPE html>
<html>
    <head>
        <title>bim chat app</title>
        <meta charset="UTF-8"/>
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>

        <script src="/socket.io/socket.io.js"></script>

        <link rel="stylesheet" href="styles/styles.css"></style>
        <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">

        <style>

          html {
            color: #e6e6e6;
          }

          button {
            display: list-item;
            margin: 1em;
            font-size: 1em;

            /*outline: #00FF00 dotted thick !important;*/
          }

          button:active {
            background: red;
          }

        </style>
    </head>
    <body style="overflow: visible;">

      <h1>Users: <span class="users">#</span></h1>
      <hr>

      <!-- TODO put this here and NOT in logs:
      <div class="promptContainer">Prompt:
        <div class="prompt">?</div>
      </div>

      <div class="scoreContainer">This/That Score:
        <div class="score">#</div>
      </div>
      -->

      <h1>Prompts</h1>
        <ul class="qContainer">
          <input type="radio" name="q" value="how do you judge a person">how do you judge a person</input><br>
          <input type="radio" name="q" value="what are you currently worried about">what are you currently worried about<br>
          <input type="radio" name="q" value="for what in your life do you feel most grateful">for what in your life do you feel most grateful<br>
          <input type="radio" name="q" value="what is your most treasured memory">what is your most treasured memory<br>
          <input type="radio" name="q" value="are you afraid of death">are you afraid of death<br>
          <input type="radio" name="q" value="would you sacrifice your life for your loved ones">would you sacrifice your life for your loved ones<br>
          <input type="radio" name="q" value="do you remain friends with your exes">do you remain friends with your exes<br>
          <input type="radio" name="q" value="how do you judge a person">how do you judge a person<br>
          <input type="radio" name="q" value="what’s something people don’t worry about but should">what’s something people don’t worry about but should<br>
          <input type="radio" name="q" value="what do you value most in a friendship">what do you value most in a friendship<br>
          <input type="radio" name="q" value="what was cool when you were young but isn’t now">what was cool when you were young but isn’t now<br>
          <input type="radio" name="q" value="what was the best thing that happened to you today">what was the best thing that happened to you today<br>
        </ul>

        <br>
        <div class="customMContainer">
          <input type="text" class="customM" placeholder="custom prompt"></input>
          <button class="custommPost" onclick="custommPost(this);">POST</button>
        </div>
      <hr>

      <h1>Yes/No Prompts</h1>
        <ul class="ttContainer">
          <input type="radio" name="tt" value="do you fear death">do you fear death</input><br>
          <input type="radio" name="tt" value="this is a yes no prompt">this is a yes no prompt</input><br>


          <input type="radio" name="tt" value="ready or not">ready or not</input><br>
          <input type="radio" name="tt" value="yes or no">yes or no</input><br>
          <input type="radio" name="tt" value="red or blue">red or blue<br>
          <input type="radio" name="tt" value="younger or older">younger or older<br>
          <input type="radio" name="tt" value="urban or suburban">urban or suburban<br>
          <input type="radio" name="tt" value="life or death">life or death<br>

        </ul>

        <br>
        <div class="customtt">
          <input type="text" class="customThis" placeholder="custom this"></input>
          <input type="text" class="customThat" placeholder="custom this"></input>
          <button class="customttPost" onclick="customttPost(this);">POST</button>
        </div>
      <hr>

      <h1>Fake OSC Responses</h1>
        <ul class="fakeOSCttContainer">This/Thats:
          <button id="this" onclick="OSCbuttonTTPress(this);">YES</button>
          <button id="that" onclick="OSCbuttonTTPress(this);">NO</button>
        </ul>



        <ul class="fakeOSCmContainer">Messages:
          <button onclick="OSCbuttonMPress(this);">bye</button>
          <button onclick="OSCbuttonMPress(this);">local</button>
        </ul>
        <div class="fakeOSCmTextContainer">
          <input type="text" class="fakeOSCmText" placeholder="fake OSC message"></input>
          <button class="fakeOSCmPost" onclick="fakeOSCmPost(this);">POST</button>
        </div>
      <hr>

      <script>

        // socket io
        var socket = io.connect(window.location.origin);
        socket.on('connect', function() {
          // console.log('connected to server socket');
          console.log(socket.id); // custom color messages
        });

        // change the radio button to keep all synced
        socket.on('changeP', function (data) {
          var promptChange = document.querySelector('input[name="'+ data.type +'"][value="'+ data.value +'"]');
          // console.log(promptChange);
          if ( promptChange != null) {
            promptChange.checked = true;
          }
        });


        socket.on('noYesCount', function (data) {
          console.log('no/yes count: ' + data);
        });


        // on dom ready
        document.addEventListener('DOMContentLoaded', function() {

          var qContainer = document.querySelector('.qContainer');
          var qSelected  = '';
          qContainer.addEventListener('click', function(e) {
            if (qSelected != document.querySelectorAll('input[name="q"]:checked')[0].value) {
              qSelected = document.querySelectorAll('input[name="q"]:checked')[0].value;
              // console.log('changed tt to: ' + ttSelected);
              socket.emit('change', {type: 'q', value: qSelected});
            }
            else {
              console.log('mis-click or same q called');
            }
          });


          var ttContainer = document.querySelector('.ttContainer');
          var ttSelected  = '';
          ttContainer.addEventListener('click', function(e) {
            if (ttSelected != document.querySelectorAll('input[name="tt"]:checked')[0].value) {
              ttSelected = document.querySelectorAll('input[name="tt"]:checked')[0].value;
              // console.log('changed tt to: ' + ttSelected);
              socket.emit('change', {type: 'tt', value: ttSelected});
            }
            else {
              console.log('mis-click or same tt called');
            }
          });

          // users
          var users = document.querySelector('.users');
          socket.on('users', function (data) {
            users.textContent = data;
          });

        });

        function OSCbuttonMPress(e) {
          // console.log(e);
          socket.emit('message', {type: 'm', value: e.innerText});
        };

        function OSCbuttonTTPress(e) {
          // console.log(e);
          socket.emit('choice', {type: 'c', button: e.id, value: e.innerText});
        };

        function customttPost(e) {
          var customThis = document.querySelector('.customThis');
          var customThat = document.querySelector('.customThat');
          // console.log(customThis.value, customThat.value);
          socket.emit('change', {type: 'tt', value: customThis.value + ' or ' + customThat.value});
          customThis.value = '';
          customThat.value = '';
        };

        function custommPost(e) {
          var customM = document.querySelector('.customM');
          // console.log(customM.value);
          socket.emit('change', {type: 'q', value: customM.value});
          customM.value = '';
        };

        function fakeOSCmPost(e) {
          var fakeOSCmText = document.querySelector('.fakeOSCmText');
          // console.log(fakeOSCmText.value);
          let m = { type: 'm', value: fakeOSCmText.value}
          socket.emit('message', m);
          fakeOSCmText.value = '';
        };

      </script>
    </body>
</html>
