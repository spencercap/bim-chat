<!DOCTYPE html>
<html>
    <head>
        <title>bim chat app</title>
        <meta charset="UTF-8"/>
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>

        <script src="/socket.io/socket.io.js"></script>

        <link rel="stylesheet" href="styles/styles.css"></style>
        <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">

        <style>

          html {
            color: #e6e6e6;
          }

          button {
            display: list-item;
            margin: 1em;
            font-size: 1em;

            /*outline: #00FF00 dotted thick !important;*/
          }

        </style>
    </head>
    <body>

      <h1>Users: <span class="users">#</span></h1>
      <hr>

      <h1>Questions</h1>
        <ul class="qContainer">
          <input type="radio" name="q" value="how do you judge a person">how do you judge a person</input><br>
          <input type="radio" name="q" value="what are you currently worried about">what are you currently worried about<br>
          <input type="radio" name="q" value="for what in your life do you feel most grateful">for what in your life do you feel most grateful<br>
          <input type="radio" name="q" value="what is your most treasured memory">what is your most treasured memory<br>
        </ul>
      <hr>

      <h1>This/That</h1>
        <ul class="ttContainer">
          <input type="radio" name="tt" value="yes or no">yes or no</input><br>
          <input type="radio" name="tt" value="red or blue">red or blue<br>
          <input type="radio" name="tt" value="younger or older">younger or older<br>
          <input type="radio" name="tt" value="urban or suburban">urban or suburban<br>
        </ul>
      <hr>

      <script>

        // socket io
        var socket = io.connect(window.location.origin);
        socket.on('connect', function() {
          // console.log('connected to server socket');
          console.log(socket.id); // custom color messages
        });

        // change the radio button to keep all synced
        socket.on('changeP', function (data) {
          var promptChange = document.querySelector('input[name="'+ data.type +'"][value="'+ data.value +'"]');
          promptChange.checked = true;
        });


        socket.on('noYesCount', function (data) {
          console.log('no/yes count: ' + data);
        });


        // on dom ready
        document.addEventListener('DOMContentLoaded', function() {

          var qContainer = document.querySelector('.qContainer');
          var qSelected  = '';
          qContainer.addEventListener('click', function(e) {
            if (qSelected != document.querySelectorAll('input[name="q"]:checked')[0].value) {
              qSelected = document.querySelectorAll('input[name="q"]:checked')[0].value;
              // console.log('changed tt to: ' + ttSelected);
              socket.emit('change', {type: 'q', value: qSelected});
            }
            else {
              console.log('mis-click or same q called');
            }
          });


          var ttContainer = document.querySelector('.ttContainer');
          var ttSelected  = '';
          ttContainer.addEventListener('click', function(e) {
            if (ttSelected != document.querySelectorAll('input[name="tt"]:checked')[0].value) {
              ttSelected = document.querySelectorAll('input[name="tt"]:checked')[0].value;
              // console.log('changed tt to: ' + ttSelected);
              socket.emit('change', {type: 'tt', value: ttSelected});
            }
            else {
              console.log('mis-click or same tt called');
            }
          });

          // users
          var users = document.querySelector('.users');
          socket.on('users', function (data) {
            users.textContent = data;
          });


        });

      </script>
    </body>
</html>
